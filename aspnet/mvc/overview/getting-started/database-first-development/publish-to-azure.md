---
uid: mvc/overview/getting-started/database-first-development/publish-to-azure
title: Опубликовать MVC Database First сайт в Azure | Документация Майкрософт
author: tfitzmac
description: С помощью MVC, Entity Framework и формирование шаблонов ASP.NET, можно создать веб-приложение, которое предоставляет интерфейс для существующей базы данных. Этот учебник seri...
ms.author: riande
ms.date: 12/22/2014
ms.assetid: 7131f1c1-cef3-4396-ab44-ed4519676546
msc.legacyurl: /mvc/overview/getting-started/database-first-development/publish-to-azure
msc.type: authoredcontent
ms.openlocfilehash: 45dd2c127e3ba0644e8168e293006fa9eadd776d
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/16/2018
ms.locfileid: "41836099"
---
<a name="publish-mvc-database-first-site-to-azure"></a>Опубликовать MVC Database First сайт в Azure
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> С помощью MVC, Entity Framework и формирование шаблонов ASP.NET, можно создать веб-приложение, которое предоставляет интерфейс для существующей базы данных. В этой серии руководств показано, как автоматически создавать код, позволяющий пользователям для отображения, изменения и создавать и удалять данные, находящиеся в таблице базы данных. Созданный код соответствует столбцам в таблице базы данных.
> 
> Части этой серии посвящена публикации веб-приложения и базы данных в Azure. Можно прочитать этот раздел, чтобы узнать о публикации веб-приложения и базы данных, но для фактического выполнения действия, которые должно начаться в начале этого руководства. См. в разделе [Приступая к работе](setting-up-database.md).


## <a name="deploy-your-web-app-on-azure"></a>Развертывание веб-приложения в Azure

Вам потребуется учетная запись Azure для работы с этим руководством:

- Вы можете [открыть учетную запись Azure бесплатно](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A261C142F) -вы получаете кредиты можно использовать для опробования платных служб Azure и даже в том случае, если они используются, вы сохраняете учетную запись и использовать бесплатные службы Azure.
- Вы можете [активировать преимущества подписчика MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F) -ваша подписка MSDN предоставляет вам кредиты каждый месяц, который можно использовать для оплаты служб Azure.

Чтобы опубликовать веб-приложения, щелкните правой кнопкой мыши проект и выберите **публикации**.

![Опубликовать сайт](publish-to-azure/_static/image1.png)

Выберите веб-сайтов Microsoft Azure.

![Выберите Azure](publish-to-azure/_static/image2.png)

Если вы не вошли Azure, укажите свои учетные данные учетной записи Azure. Выберите создать, чтобы создать новое веб-приложение.

![новый сайт](publish-to-azure/_static/image3.png)

Создайте уникальное имя для веб-приложения. Вы будете знать имя должно быть уникальным, если появится Зеленый флажок справа от поля name. Выберите регион для веб-приложения. Выберите **создать сервер** для базы данных и укажите имя пользователя и пароль для этого нового сервера базы данных. Закончив, нажмите кнопку **создать**.

![Создание сайта](publish-to-azure/_static/image4.png)

Значения подключения теперь все готово. Можно оставить эти значения без изменений.

![connection](publish-to-azure/_static/image5.png)

Нажмите кнопку **Далее**.

Для параметров, указанных Обратите внимание на то, что два подключений к базе данных - ApplicationDBContext и ContosoUniversityDataEntities. ApplicationDBContext — подключение для таблицы учетной записи пользователя. Эти значения отображаются только строки подключения для базы данных. Это означает, что эти базы данных будет опубликован, при публикации веб-узла. Как опубликовать проект базы данных после завершения публикации веб-приложения.

![](publish-to-azure/_static/image6.png)

Кнопку с многоточием (...) рядом с подключения к базе данных отображает сведения о строке подключения. Нажмите кнопку с многоточием рядом с ContosoUniversityDataEntities.

![](publish-to-azure/_static/image7.png)

Обратите внимание на имя сервера базы данных и базы данных. Имя сервера формируется случайным образом. Имя базы данных — простое имя узла с  **\_db** добавляется. Он потребуется имена обоих позже при публикации базы данных.

Нажмите кнопку **ОК** чтобы закрыть окно строку подключения базы данных.

В окне «Публикация веб-сайта» выберите **Далее** для предварительного просмотра.

![](publish-to-azure/_static/image8.png)

Если щелкнуть начать просмотр, чтобы просмотреть список файлов для публикации. Так как это первый раз, вы опубликовали этот сайт, список будет каждый соответствующий файл в проекте.

Нажмите кнопку **Опубликовать**.

В области выходных данных отобразится результат публикации.

![](publish-to-azure/_static/image9.png)

После публикации сам сайт находится immedialely запущено в браузере. Развертывания веб-узла и сможете зарегистрировать нового пользователя на сайте. Тем не менее таблицы в проекте ContosoUniversityData не еще были опубликованы. Если щелкнуть в списке учащихся связи вы получите ошибку.

## <a name="publish-database-to-sql-azure"></a>Публикация базы данных SQL Azure

Перед публикацией базы данных, необходимо убедиться в том, что ваш локальный компьютер может подключиться к серверу базы данных. Ограничивает брандмауэр для сервера базы данных, в которой машины могут подключаться к базе данных. Необходимо добавить IP-адрес компьютера для разрешенных IP-адресов для брандмауэра.

Войдите в учетную запись Azure через портал Azure.

Выберите новую базу данных и выберите **управление**.

![Управление](publish-to-azure/_static/image10.png)

Необходимо настроить серверу базы данных, чтобы разрешить подключения с вашего компьютера. Когда вы выбираете управление, вам будет предложено добавить текущий IP-адрес, разрешенными для сервера базы данных. Выберите "Да".

![Добавление IP-адреса](publish-to-azure/_static/image11.png)

Есть вероятность того, не только IP-адрес, необходимо настроить для подключений IP-адрес, добавленного на предыдущем шаге. Попробуйте выполнить вход в базу данных на наличие подключений были правильно настроены. Укажите имя пользователя и пароль, созданный ранее.

![Вход](publish-to-azure/_static/image12.png)

Если появится сообщение об ошибке, необходимо добавить другой IP-адрес. Щелкните сообщение об ошибке для получения дополнительных сведений об ошибке. В области сведений вы увидите IP-адрес, который необходимо добавить. Запишите этот IP-адрес.

![не допускается](publish-to-azure/_static/image13.png)

Закройте это окно входа в систему и возврата к порталу Azure.

Перейдите к панели мониторинга для базы данных. Нажмите кнопку **управление разрешенными IP-адреса**.

![Управление IP-адресами](publish-to-azure/_static/image14.png)

Теперь необходимо добавить IP-адрес из сообщения об ошибке. Изменить диапазон разрешенных IP-адресов, чтобы включить один из сообщения об ошибке, либо добавить этот IP-адрес как отдельный элемент.

![Добавить новый адрес](publish-to-azure/_static/image15.png)

Сохраните изменения для разрешенных IP-адресов.

Щелкните "Управление" и повторите попытку входа в базе данных. Может потребоваться подождать несколько минут, прежде чем разрешенных IP-адресов настроены правильно для брандмауэра. Когда вы можете успешно войти в базе данных, завершения установки подключения к базе данных.

Это окно управления можно оставить открытым, так как производится проверка результат развертывания базы данных вскоре.

Вернуть в проект базы данных. Щелкните правой кнопкой мыши проект и выберите **публикации**.

![опубликовать базу данных](publish-to-azure/_static/image16.png)

В окне «опубликовать базу данных» выберите **изменить**.

![изменение;](publish-to-azure/_static/image17.png)

Укажите имя сервера базы данных и учетные данные проверки подлинности для сервера. После предоставления учетных данных, выберите базу данных, которую вы создали, из списка доступных баз данных. По умолчанию Visual Studio задает имя поля базы данных, имя проекта, который не может быть таким же, как базы данных, которую вы создали.

![](publish-to-azure/_static/image18.png)

Нажмите кнопку ОК.

Возможно, потребуется сохранить профиль, чтобы вы могли публиковать обновления в будущем без необходимости повторного ввода всех сведений о соединении. Выберите **Создать профиль**.

![сохранить профиль](publish-to-azure/_static/image19.png)

Она создаст файл с именем проекта **ContosoUniversityData.publish.xml**. В следующий раз, вы хотите опубликовать базу данных в Azure, просто загрузите этот профиль.

Теперь щелкните **публикации** для создания базы данных в Azure.

![publish](publish-to-azure/_static/image20.png)

После выполнения команды некоторое время публикация результатов отображаются.

![results](publish-to-azure/_static/image21.png)

Теперь можно вернуться на портал управления для базы данных. Обновите представление конструктора и обратите внимание, что были развернуты 3 таблицы предварительно заполняется данными.

![новые таблицы](publish-to-azure/_static/image22.png)

Теперь все готово для тестирования веб-приложения, которое развертывается в Azure. Перейдите к веб-приложения в Azure (таких как http://contosositeexample.azurewebsites.net/). Щелкните ссылку для списка студентов, и вы увидите представление index для учащихся.

![view](publish-to-azure/_static/image23.png)

В некоторых случаях базы данных и соединения требуется некоторое время, чтобы правильно настроить. Если произошла ошибка, подождите несколько минут и повторите попытку.

## <a name="conclusion"></a>Заключение

В этой серии предоставлен простой пример того, как создать код из существующей базы данных, который позволяет пользователям изменять, обновлять, создавать и удалять данные. Он используется ASP.NET MVC 5, Entity Framework и формирование шаблонов ASP.NET для создания проекта.

Вводный пример шаблона разработки Code First, см. в разделе [Приступая к работе с ASP.NET MVC 5](../introduction/getting-started.md).

Более сложный пример, см. в разделе [Создание модели данных Entity Framework для приложения ASP.NET MVC 4](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md). Обратите внимание, что API DbContext, который используется для работы с данными в базе данных первого так же, как API, который используется для работы с данными в Code First. Даже если вы планируете использовать Database First, рассказывается, как обрабатывать более сложные сценарии, такие как чтение и обновление связанных данных, обработка конфликтов параллелизма, и так далее из учебника Code First. Единственное различие — в том, как создать базу данных, класс контекста и классов сущностей.

> [!div class="step-by-step"]
> [Назад](enhancing-data-validation.md)

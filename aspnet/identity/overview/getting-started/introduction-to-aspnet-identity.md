---
uid: identity/overview/getting-started/introduction-to-aspnet-identity
title: Введение в ASP.NET Identity | Документация Майкрософт
author: jongalloway
description: Система членства ASP.NET впервые появилась в ASP.NET 2.0 обратно в 2005 г., а поскольку затем произошло много изменений в инициированная приложений web способов...
ms.author: riande
ms.date: 10/17/2013
ms.assetid: 38717fc1-5989-43cf-952d-4007cc1dd923
msc.legacyurl: /identity/overview/getting-started/introduction-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 24674adf1f28b3ffc0822a4b112c972d1e7ed5b4
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/16/2018
ms.locfileid: "41829388"
---
<a name="introduction-to-aspnet-identity"></a>Введение в ASP.NET Identity
====================
по [Джон Гэллоуэй](https://github.com/jongalloway), [Пранавом Растоги](https://github.com/rustd), [Рик Андерсон](https://github.com/Rick-Anderson), [том Дайкстра](https://github.com/tdykstra)

> Система членства ASP.NET впервые появилась в ASP.NET 2.0 обратно в 2005 г., а поскольку затем произошло много изменений одним из способов проверки подлинности и авторизации веб-приложения обычно обрабатывают. ASP.NET Identity — это Свежий взгляд на то, что система членства должно быть при создании современных приложений для Интернета, телефона или планшета.
> 
> Эта статья написана с Пранавом Растоги ([@rustd](https://twitter.com/rustd)), Джон Гэллоуэй ([@jongalloway](https://twitter.com/jongalloway)), том Дайкстра и Рик Андерсон ([ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) ).


## <a name="background-membership-in-aspnet"></a>Фон: Членства в ASP.NET

### <a name="aspnet-membership"></a>Членства ASP.NET

[Членство ASP.NET](https://msdn.microsoft.com/library/yh26yfzy(v=VS.100).aspx) разработана для решения требований к членству сайта, которые были приняты в 2005, в которой участвует проверки подлинности форм и базы данных SQL Server для имен пользователей, пароли и данные профиля. Сегодняшний день не существует много широкого ряда варианты хранения данных для веб-приложений и хотите разрешить их сайтов использовать Поставщики удостоверений социальных сетей для работы функций проверки подлинности и авторизации большинства разработчиков. Ограничения членства ASP.NET разработки усложнить этот переход:

- Схемы базы данных было разработано для SQL Server и его невозможно изменить. Вы можете добавить данные профиля, но дополнительные данные, упакована в другую таблицу, что затрудняет для доступа к любым способом, за исключением через API-Интерфейс поставщика профиля.
- Поставщик системы позволяет изменить хранилище данных, но система разработано на основе предположения, которые подходят для реляционной базы данных. Можно написать поставщика для хранения сведений о членстве в механизм и нереляционные хранилища, такие как таблицы хранилища Azure, но это обойти реляционных проектирования, написания большого объема кода и большой объем `System.NotImplementedException` исключения для методов, которые не применить к базам данных NoSQL.
- Так как функциональные возможности log in/log out основан на проверке подлинности форм, система членства нельзя использовать [OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md). OWIN включает в себя компоненты по промежуточного слоя для проверки подлинности, включая поддержку входа с помощью внешних поставщиков удостоверений (например, учетные записи Майкрософт, Facebook, Google, Twitter) и входа с учетными записями организации из локальной Active Directory или Azure Active Directory. OWIN также включает поддержку OAuth 2.0, JWT и CORS.

### <a name="aspnet-simple-membership"></a>Членство ASP.NET Simple

[Простого членства ASP.NET](../../../web-pages/overview/security/16-adding-security-and-membership.md) была разработана как система членства ASP.NET Web Pages. Он был выпущен вместе с WebMatrix и Visual Studio 2010 с пакетом обновления 1. Цель простого членства — позволяют легко добавить функции членства для приложения веб-страниц.

Простого членства поступивший проще настроить сведения о профиле пользователя, но она по-прежнему имеет другие проблемы с членства ASP.NET и он имеет некоторые ограничения:

- Это было настолько сложно для сохранения данных о членстве системы в нереляционного хранилища.
- Его нельзя использовать с OWIN.
- Он не работает с существующими поставщиками членства ASP.NET, и он не является расширяемым.

### <a name="aspnet-universal-providers"></a>Универсальные поставщики ASP.NET

[Универсальные поставщики ASP.NET](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx) разработанные, чтобы обеспечить возможность сохранять информацию членства в Microsoft, база данных SQL Azure и они также работать с SQL Server Compact. Универсальные поставщики были построены из Entity Framework Code First, это означает, что универсальные поставщики может использоваться для сохранения данных в любое хранилище, поддерживаемых EF. Универсальные поставщики схему базы данных был очищен также довольно много.

Универсальные поставщики создаются по инфраструктуре членства ASP.NET, поэтому они по-прежнему содержать те же ограничения, что поставщик SqlMembership. То есть они были созданы для реляционных баз данных и это усложняет их настройку профиля и сведения о пользователях. Эти поставщики по-прежнему используют проверку подлинности форм для входа и выхода из функции.

## <a name="aspnet-identity"></a>ASP.NET Identity

Членства в истории в ASP.NET развивался с годами, группа разработчиков ASP.NET много узнал от отзывов клиентов.

В предположении, что пользователи будут входить систему, указав имя пользователя и пароль, который они зарегистрированы в приложении больше не является допустимым. Веб-узла становится более социальных сетей. Пользователи взаимодействуют друг с другом в режиме реального времени с помощью социальных сетей, таких как Facebook, Twitter и других социальных веб-сайтов. Разработчики предпочитают, чтобы пользователи могли выполнять вход с их удостоверениями социальных сетей, чтобы они могут иметь более удобной на своих веб-сайтах. Это система членства современных необходимо включить на основе перенаправления входами поставщикам проверки подлинности, таких как Facebook, Twitter и другие.

Как развитие веб-разработки, что привело шаблонов разработки веб-приложений. Модульного тестирования кода приложения стала основной проблемой для разработчиков приложений. В 2008 ASP.NET добавлена новая платформа, на основе шаблона Model-View-Controller (MVC), отчасти для того, чтобы помочь разработчикам создавать модульные тестируемых приложений ASP.NET. Разработчики, желающие модульного тестирования логики своих приложений, также хотели бы иметь возможность сделать это с помощью системы членства.

Учитывая эти изменения в разработке веб-приложений ASP.NET Identity был разработан для следующих целей:

- **Одну систему ASP.NET Identity**

    - ASP.NET Identity можно использовать со всеми платформы ASP.NET, такие как ASP.NET MVC, Web Forms, веб-страниц, веб-API и SignalR.
    - ASP.NET Identity можно использовать при построении Интернета, phone, магазина или гибридных приложений.
- **Простота подключения профиля данных о пользователе**

    - Вы можете контролировать схему пользователя и сведения о профиле. Например вы можете легко включить системой для хранения даты рождения, вводимые пользователем при регистрации учетной записи в приложении.

- **Элемент управления сохраняемости**

    - По умолчанию система ASP.NET Identity хранит все данные пользователя в базе данных. ASP.NET Identity использует Entity Framework Code First для реализации всех механизма сохранения.
    - Так как управлять схемой базы данных, общие задачи, такие как изменение имен таблиц или тип данных первичные ключи процедура аналогична.
    - Легко подключите в хранилища различных механизмов, таких как SharePoint, службу таблиц хранилища Azure, базами данных NoSQL и др., без необходимости создавать `System.NotImplementedExceptions` исключения.
- **Возможности модульного тестирования**

    - ASP.NET Identity делает его веб-приложения более пригодного для тестирования. Можно написать модульные тесты для части приложения, использующие ASP.NET Identity.
- **Поставщик ролей**

    - Нет поставщика ролей, который позволяет ограничить доступ к частям приложения ролей. Можно легко создавать роли, например «Admin» и добавление пользователей к ролям.
- **На основе утверждений**

    - ASP.NET Identity поддерживает аутентификации на основе утверждений, где удостоверение пользователя представляется в виде набора утверждений. Утверждения позволяют разработчикам быть гораздо более выразительной, в описании идентификатора пользователя, чем роли. В то время как членство в роли — это просто логическое значение (элемент или являющихся членами), утверждение может включать подробные сведения об удостоверениях и членстве пользователя.
- **Учетные записи социальных сетей поставщиков**

    - Можно легко добавить социальных сетей журнала модулей, таких как учетная запись Майкрософт, Facebook, Twitter, Google и других в приложение и хранения данных конкретного пользователя в приложении.
- **Azure Active Directory**

    - Также можно добавить функции входа с помощью Azure Active Directory и хранения данных конкретного пользователя в приложении. Дополнительные сведения см. в разделе [учетные записи организации](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauth) в создание веб-проектов ASP.NET в Visual Studio 2013
- **Интеграция OWIN**

    - Проверка подлинности ASP.NET теперь основана на по промежуточного слоя OWIN, который может использоваться на любом узле на основе OWIN. ASP.NET Identity имеет любую зависимость на System.Web. Он представляет собой полностью соответствует OWIN и может использоваться в любом приложении OWIN размещенных.
    - Удостоверение ASP.NET использует проверку подлинности OWIN для журнала или журнала обслужен пользователей на веб-сайте. Это означает, что вместо использования FormsAuthentication для создания файла cookie, приложение использует OWIN CookieAuthentication для этого.
- **Пакет NuGet**

    - ASP.NET Identity распространяется как пакет NuGet, который устанавливается в шаблонах ASP.NET MVC, веб-форм и веб-API, входящие в состав Visual Studio 2013. Этот пакет NuGet можно загрузить из галереи NuGet.
    - Освобождение ASP.NET Identity в виде NuGet пакета упрощает перебирайте новые функции и исправления ошибок и доставлять их разработчикам гибкое группа разработчиков ASP.NET.

## <a name="getting-started-with-aspnet-identity"></a>Приступая к работе с ASP.NET Identity

ASP.NET Identity используется в шаблонах проектов Visual Studio 2013 для ASP.NET MVC, Web Forms, веб-API и одностраничных ПРИЛОЖЕНИЙ. В этом пошаговом руководстве будет показано, как шаблоны проектов использовать удостоверения ASP.NET Добавление функциональных возможностей, регистрация, вход и выход пользователя.

ASP.NET Identity реализуется с помощью следующей процедуры. Цель этой статьи является приведу общий обзор ASP.NET Identity; можно переходить по нему шаг за шагом или просто ознакомиться с подробностями. Более подробные инструкции по созданию приложений с помощью ASP.NET Identity, включая добавление пользователей, роли и сведения о профиле, с помощью нового API см. в разделе "Дальнейшие действия" в конце этой статьи.

1. Создание приложения ASP.NET MVC с отдельным учетным записям. Можно использовать ASP.NET Identity в ASP.NET MVC, Web Forms, веб-API, SignalR и т.д. В этой статье мы начнем с приложением ASP.NET MVC.  
  
    ![](introduction-to-aspnet-identity/_static/image1.png)
2. Созданный проект содержит следующие три пакета для ASP.NET Identity.

    - [`Microsoft.AspNet.Identity.EntityFramework`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/)  
   Этот пакет имеет Entity Framework реализация ASP.NET Identity, которая сохранит данные ASP.NET Identity и схему для SQL Server.
    - [`Microsoft.AspNet.Identity.Core`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Core/)  
   Этот пакет содержит базовых интерфейсов для ASP.NET Identity. Этот пакет можно создать реализацию для ASP.NET Identity, что сохраняемости на разных целевых объектов хранилища, такие как хранилище таблиц Azure, NoSQL баз данных и т.д.
    - [`Microsoft.AspNet.Identity.OWIN`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Owin/)  
   Этот пакет содержит функции, используемое для подключения в OWIN проверки подлинности в ASP.NET Identity в приложениях ASP.NET. Используется при добавлении журнала функциональных возможностей в приложении и вызвать в по промежуточного слоя OWIN проверки подлинности файла Cookie для создания файла cookie.
3. Создание пользователя.  
   Запустите приложение и выберите команду **зарегистрировать** ссылку, чтобы создать пользователя. Ниже показана страница регистр, который собирает имя пользователя и пароль.  
  
    ![](introduction-to-aspnet-identity/_static/image2.png)  
  
   Когда пользователь щелкает **зарегистрировать** кнопки `Register` контроллера учетных записей создается пользователь, вызвав API удостоверения ASP.NET, как показано ниже:

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample1.cs?highlight=8-9)]
4. Вход.  
   Если пользователь был успешно создан, она регистрирует `SignInAsync` метод.  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample2.cs?highlight=12)]

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample3.cs?highlight=5-6)]

   Выделенный код выше в `SignInAsync` метод создает [ClaimsIdentity](https://msdn.microsoft.com/library/system.security.claims.claimsidentity.aspx). Так как ASP.NET Identity и OWIN файл Cookie проверки подлинности на основе утверждений система, платформа требует приложения для создания ClaimsIdentity для пользователя. ClaimsIdentity имеет сведения о все утверждения для пользователя, например пользователь принадлежит к роли. На этом этапе можно также добавить дополнительные утверждения для пользователя.  
  
   Выделенный код ниже в `SignInAsync` метод входит в систему пользователя с AuthenticationManager из OWIN и вызывая метод `SignIn` и передавая ClaimsIdentity.  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample4.cs?highlight=8-11)]
5. Выйдите из системы.  
   Щелкнув **выйти** ссылку вызывает действие выхода из системы в контроллере account. 

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample5.cs?highlight=6)]

   Выделенный выше код демонстрирует OWIN `AuthenticationManager.SignOut` метод. Это аналогично [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) метод, используемый [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) модуля в веб-форм.

## <a name="components-of-aspnet-identity"></a>Компоненты ASP.NET Identity

На следующей схеме показаны компоненты системы ASP.NET Identity (щелкните [это](introduction-to-aspnet-identity/_static/image3.png) или на диаграмме, чтобы увеличить его). Пакеты зеленым цветом составляющих систему ASP.NET Identity. Все пакеты, зависимости, необходимые для использования системы удостоверений ASP.NET в приложениях ASP.NET.

[![](introduction-to-aspnet-identity/_static/image5.png)](introduction-to-aspnet-identity/_static/image4.png)

Вот краткое описание пакетов NuGet, не упомянутые ранее:

- [Microsoft.Owin.Security.Cookies](http://www.nuget.org/packages/Microsoft.Owin.Security.Cookies/)  
 Промежуточный слой, который позволяет приложению использовать файл cookie на основе проверки подлинности, аналогичную ASP. NET-проверки подлинности форм.
- [EntityFramework](http://www.nuget.org/packages/EntityFramework/)  
 Платформа Entity Framework — технология доступа к данных, рекомендуемые корпорации Майкрософт для реляционных баз данных.

## <a name="migrating-from-membership-to-aspnet-identity"></a>Миграция из членства в ASP.NET Identity

Мы надеемся вскоре предоставить рекомендации по переносу существующих приложений, использующих ASP.NET или простой членства в новую систему ASP.NET Identity.

## <a name="next-steps"></a>Следующие шаги

- [Создать приложение ASP.NET MVC 5 с помощью Facebook и Google OAuth2 и OpenID единого входа](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md)  
 В руководстве используется API удостоверения ASP.NET, чтобы добавить сведения о профиле для пользовательской базы данных и как выполнять аутентификацию в Google и Facebook.
- [Создание приложения ASP.NET MVC с проверкой подлинности и база данных SQL и развертывание в службе приложений Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data)  
 Этом руководстве показано, как использовать API удостоверения для добавления пользователей и ролей.
- [Учетные записи отдельных пользователей](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#indauth) при создании проектов веб-ASP.NET в Visual Studio 2013
- [Учетные записи организации](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauth) при создании проектов веб-ASP.NET в Visual Studio 2013
- [Настройка сведения о профиле в ASP.NET Identity в шаблонах Visual STUDIO 2013](https://blogs.msdn.com/b/webdev/archive/2013/10/16/customizing-profile-information-in-asp-net-identity-in-vs-2013-templates.aspx)
- [Получение дополнительных сведений из поставщиков социальных сетей, используемые в шаблонах проектов Visual STUDIO 2013](https://blogs.msdn.com/b/webdev/archive/2013/10/16/get-more-information-from-social-providers-used-in-the-vs-2013-project-templates.aspx)
- [https://github.com/rustd/AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample)  
 Образец приложения, показано, как добавлять основные роли и поддержка пользователей и инструкции по выполнению ролей и управление пользователями.
